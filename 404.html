<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redirecting...</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <style>
        body {            
          display: flex;
          flex-direction: row;
          align-items: center;
          justify-content: center;
          height: 99vh;
        }
    </style>
    <script>
        // Initialize Firebase with your configuration
        var firebaseConfig = {
            apiKey: "AIzaSyAvC3w2OJatNPTfOD0YE5-v24XYul2vg7s",
            authDomain: "anonymous-messages-692c3.firebaseapp.com",
            projectId: "anonymous-messages-692c3",
            storageBucket: "anonymous-messages-692c3.appspot.com",
            messagingSenderId: "152307243781",
            appId: "1:152307243781:web:f9e7787bcab188aefa756c"
        };

        firebase.initializeApp(firebaseConfig);
        var db = firebase.firestore();

        document.addEventListener("DOMContentLoaded", function() {
            // Extract the username from the current URL
            var path = window.location.pathname;
            var user = path.split("/").pop();  // Get the last part of the URL, i.e., 'antar'
            
            if (user) {
                // Check if user exists in Firebase
                db.collection('users').doc(user).get().then((doc) => {
                    if (doc.exists) {
                        // User found, redirect to user.html with query parameter
                        window.location.href = `/user.html?user=${user}`;
                    } else {
                        // User not found, show error
                        document.body.innerHTML = `
                            <div><h1>Error: User not found</h1><br>
                            <p>The user you're looking for doesn't exist.<br><a href="https://dakbaksho.github.io/" style="text-decoration: none;">Go back to the homepage</a></p>
                            </div>
                            `;
                   ;
                    }
                }).catch((error) => {
                    console.error("Error fetching user:", error);
                    document.body.innerHTML = "<h1>Error: Unable to fetch user</h1>";
                });
            } else {
                // If no user is found, redirect to the home page or a default page
                window.location.href = `/index.html`;
            }
        });
    </script>
</head>
<body>
    <h1>Searching User...</h1>
</body>
</html>
